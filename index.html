<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Técnico en Calidad</title>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD9g63vlae7tdmC5QCbZDz_nattCaoagb0",
    authDomain: "fundateccalidad-155c4.firebaseapp.com",
    projectId: "fundateccalidad-155c4",
    storageBucket: "fundateccalidad-155c4.firebasestorage.app",
    messagingSenderId: "498357053508",
    appId: "1:498357053508:web:25100503c913bded02f411",
    measurementId: "G-V5B788PMW8"
  };

  const app = initializeApp(firebaseConfig);
  window.auth = getAuth(app);
</script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap');

body {
  margin: 0;
  font-family: 'Montserrat', sans-serif;
  background: linear-gradient(135deg, #001533, #002266);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
}

.container {
  background: #fff;
  color: #333;
  border-radius: 15px;
  max-width: 500px;
  width: 100%;
  padding: 35px 45px;
  box-shadow: 0 12px 30px rgba(0,0,0,0.4);
  animation: fadeInUp 0.8s ease forwards;
  transition: transform 0.3s ease;
  position: relative;
}
.container:hover { transform: translateY(-5px); }

h1 { margin-top: 0; font-weight: 700; text-align: center; color: #001f4d; }
p { font-size: 1rem; line-height: 1.5; margin-bottom: 25px; text-align: center; }
ul.steps {
  background: #cce0ff;
  border-radius: 10px;
  padding: 20px 25px;
  color: #001f4d;
  font-weight: 600;
  margin-bottom: 30px;
  box-shadow: inset 0 0 12px #99bbff;
}
ul.steps li { margin-bottom: 12px; }

form { display: flex; flex-direction: column; align-items: center; }

input[type="email"], input[type="password"], button {
  width: 100%;
  max-width: 400px;
  margin: 10px 0;
  padding: 15px 20px;
  font-size: 1rem;
  border-radius: 10px;
  text-align: center;
  transition: all 0.3s ease;
}

input[type="email"], input[type="password"] { border: 2px solid #001f4d; }
input[type="email"]:focus, input[type="password"]:focus {
  outline: none;
  border-color: #0044cc;
  box-shadow: 0 0 10px rgba(0,68,204,0.5);
}

button {
  background: linear-gradient(90deg, #001f4d, #003366);
  color: white;
  font-weight: 700;
  border: none;
  cursor: pointer;
  font-size: 1.2rem;
  padding: 18px 0;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  animation: buttonEntrance 0.5s ease forwards;
}
button:hover { background: linear-gradient(90deg, #002266, #0044cc); transform: translateY(-3px); }
button:active { transform: scale(0.97); }

.confirmation {
  margin-top: 20px;
  text-align: center;
  font-size: 1rem;
  color: green;
  display: none;
  font-weight: 600;
  opacity: 0;
  transition: opacity 0.5s ease;
}

.errorMsg {
  margin-top: 10px;
  color: red;
  font-weight: 600;
  display: none;
}

@keyframes fadeInUp { 0% { opacity: 0; transform: translateY(30px); } 100% { opacity: 1; transform: translateY(0); } }
@keyframes fadeOutDown { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(30px); } }
@keyframes buttonEntrance { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<div class="container" id="container">
  <h1>Eliminar tu cuenta del Técnico en Calidad</h1>

  <ul class="steps">
    <li>1. Abre la aplicación <strong>Técnico en Calidad</strong>.</li>
    <li>2. Toca el botón <strong>"Eliminar Cuenta"</strong> en inicio de sesión.</li>
    <li>3. Aparecerá un mensaje de confirmación.</li>
    <li>4. Selecciona <strong>Sí</strong> para continuar.</li>
  </ul>

  <p>Si prefieres, solicita que borremos tus datos aquí:</p>

  <form id="eliminarForm" action="https://formsubmit.co/asistenciatecnicostec@gmail.com" method="POST">
    <input type="email" name="email" placeholder="Tu correo electrónico" required autocomplete="email" />
    <input type="password" name="password" placeholder="Tu contraseña" required autocomplete="current-password" />
    <input type="hidden" name="Mensaje" value="Deseo eliminar mi cuenta de la aplicación Técnico en Calidad" />
    <input type="hidden" name="_subject" value="Solicitud de eliminación de cuenta - Técnico en Calidad" />
    <input type="hidden" name="_captcha" value="false" />
    <button type="submit">Solicitar</button>
    <p class="errorMsg" id="errorMsg">Correo o contraseña incorrectos.</p>
  </form>

  <p class="confirmation" id="confirmationMsg">¡Solicitud enviada! Revisa tu correo para confirmar.</p>
</div>

<script type="module">
  import { signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.3.0/firebase-auth.js";

  const form = document.getElementById('eliminarForm');
  const confirmationMsg = document.getElementById('confirmationMsg');
  const container = document.getElementById('container');
  const errorMsg = document.getElementById('errorMsg');
  const auth = window.auth;

  form.addEventListener('submit', function(event) {
    event.preventDefault();
    const email = form.email.value;
    const password = form.password.value;

    signInWithEmailAndPassword(auth, email, password)
    .then((userCredential) => {
      const formData = new FormData(form);
      fetch(form.action, {
        method: form.method,
        body: formData,
        headers: { 'Accept': 'application/json' },
      })
      .then(response => {
        if(response.ok){
          // Crear mensaje intermedio
          const intermediateMsg = document.createElement('p');
          intermediateMsg.textContent = "Tu solicitud fue enviada";
          intermediateMsg.style.color = "green";
          intermediateMsg.style.fontWeight = "bold";
          intermediateMsg.style.textAlign = "center";
          intermediateMsg.style.position = "absolute";
          intermediateMsg.style.top = "50%";
          intermediateMsg.style.left = "50%";
          intermediateMsg.style.transform = "translate(-50%, -50%)";
          intermediateMsg.style.fontSize = "1.2rem";
          intermediateMsg.style.opacity = 0;
          intermediateMsg.style.transition = "opacity 0.5s ease";
          document.body.appendChild(intermediateMsg);
          setTimeout(() => { intermediateMsg.style.opacity = 1; }, 50);

          // Animación de salida del contenedor
          container.style.animation = 'fadeOutDown 0.5s forwards';
          setTimeout(() => { container.style.display = 'none'; }, 500);

          // Mostrar mensaje intermedio 2s antes de desaparecer
          setTimeout(() => {
            intermediateMsg.style.opacity = 0;
            setTimeout(() => { intermediateMsg.remove(); }, 500);

            confirmationMsg.style.display = 'block';
            setTimeout(() => { confirmationMsg.style.opacity = 1; }, 50);

            form.reset();

            setTimeout(() => {
              confirmationMsg.style.opacity = 0;
              setTimeout(() => { confirmationMsg.style.display = 'none'; }, 500);
              container.style.display = 'block';
              container.style.animation = 'fadeInUp 0.8s ease forwards';
            }, 5000);
          }, 2000);
        }
      });
    })
    .catch((error) => {
      errorMsg.style.display = 'block';
      setTimeout(() => { errorMsg.style.display = 'none'; }, 4000);
    });
  });
</script>

</body>
</html>
